<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Layout Only</title>
    <!-- CSS ì—°ê²° -->
    <link rel="stylesheet" href="slide.css" />
    <link rel="stylesheet" href="project.css" />
    <script type="module" src="nav-search.js" defer></script>
  </head>

  <body>
    <div class="container">
      <!-- Header -->
      <header class="top">
        <div class="app-icon">
          <img src="image-4.png" alt="app icon" />
        </div>

        <div class="title" onclick="location.href = 'test copy.html'">
          <h1>ì˜¤ëŠ˜ ë­ ë¨¹ì§€?</h1>
          <p>ì¶”ì²œ ìš”ë¦¬ì˜ ë ˆì‹œí”¼ì™€ ë§›ì§‘ì„ í•œë²ˆì— ì¶”ì²œ</p>
        </div>
      </header>

      <!-- Sticky Nav -->
      <div class="nav-wrap">
        <nav class="nav">
          <div class="nav-item" onclick="location.href = 'survey.html'">
            <span>ì˜¤ëŠ˜ ë­ ë¨¹ì§€?</span>
          </div>

          <!-- ë ˆì‹œí”¼ -->
          <div class="nav-item recipe" onclick="location.href = 'search.html'">
            <span>ë ˆì‹œí”¼</span>

            <div class="dropdown">
              <button
                class="drop-item"
                onclick="
                  event.stopPropagation();
                  location.href = 'search.html?q=ì–‘ì‹';
                "
              >
                ì–‘ì‹
              </button>
              <button
                class="drop-item"
                onclick="
                  event.stopPropagation();
                  location.href = 'search.html?q=ì¤‘ì‹';
                "
              >
                ì¤‘ì‹
              </button>
              <button
                class="drop-item"
                onclick="
                  event.stopPropagation();
                  location.href = 'search.html?q=ì¼ì‹';
                "
              >
                ì¼ì‹
              </button>
              <button
                class="drop-item"
                onclick="
                  event.stopPropagation();
                  location.href = 'search.html?q=í•œì‹';
                "
              >
                í•œì‹
              </button>
            </div>
          </div>

          <div class="nav-item" onclick="location.href = 'map.html'">
            <span>ë§›ì§‘ ì§€ë„</span>
          </div>

          <!-- ê²€ìƒ‰ -->
          <div class="nav-item search">
            <form class="search-box">
              <input
                type="text"
                id="searchInput"
                placeholder="ë ˆì‹œí”¼/ë§›ì§‘ ê²€ìƒ‰"
              />
              <button type="submit">ê²€ìƒ‰</button>
            </form>
          </div>
        </nav>
      </div>

      <main class="stage">
        <div class="containers">
          <div class="slides">
            <div class="slide"></div>
            <div class="slide"></div>
            <div class="slide"></div>
            <div class="slide"></div>
            <div class="slide"></div>
            <div class="slide"></div>
            <div class="slide"></div>
          </div>
          <div class="buttons">
            <button class="prev">â—€</button>
            <button class="next">â–¶</button>
          </div>

          <div class="dots"></div>
        </div>
      </main>
      <main2 class="main2">
        <div class="category-wrap">
          <div class="category">
            <button class="cat-item active">ì–‘ì‹</button>
            <button class="cat-item">ì¤‘ì‹</button>
            <button class="cat-item">í•œì‹</button>
            <button class="cat-item">ì¼ì‹</button>
          </div>

          <div class="sub-menu">
            <div class="sub-list"></div>
          </div>
        </div>
        <div class="map-wrap">
          <div class="map" id="map"></div>
        </div>
        <div class="eating-what">
          <img class="pepe sad" src="image-float.png" alt="" />
          <img class="pepe happy" src="a881e4a0100d9502adasd.png" alt="" />

          <a href="survey.html" class="click-area"></a>
        </div>
      </main2>
    </div>

    <!-- JS ì—°ê²° -->
  </body>
  <script
    type="text/javascript"
    src="//dapi.kakao.com/v2/maps/sdk.js?appkey=352fd6f92267a000366c752810dc58cd"
  ></script>
  <script>
    var mapContainer = document.getElementById("map");
    var options = {
      center: new kakao.maps.LatLng(37.570175, 126.982359),
      level: 3,
    };

    var map = new kakao.maps.Map(mapContainer, options);

    var markerPosition = new kakao.maps.LatLng(37.570175, 126.982359);
    var marker = new kakao.maps.Marker({
      position: markerPosition,
    });

    marker.setMap(map);
  </script>
  <script src="slide.js"></script>
  <script src="menu.js"></script>
  <script src="recipe.js"></script>
  <script>
    const cats = document.querySelectorAll(".cat-item");

    cats.forEach((btn) => {
      btn.addEventListener("click", () => {
        document.querySelector(".cat-item.active")?.classList.remove("active");
        btn.classList.add("active");
      });
    });
    const grouped = menus.reduce((acc, menu) => {
      const key = menu.cuisine;

      if (!acc[key]) {
        acc[key] = [];
      }

      acc[key].push(menu.name);

      return acc;
    }, {});

    const data = grouped;

    const buttons = document.querySelectorAll(".cat-item");
    const subList = document.querySelector(".sub-list");

    function render(category) {
      subList.innerHTML = data[category]
        .map((item) => `<div class="sub-item">${item}</div>`)
        .join("");
    }

    render("ì–‘ì‹");

    buttons.forEach((btn) => {
      btn.addEventListener("click", () => {
        buttons.forEach((b) => b.classList.remove("active"));
        btn.classList.add("active");
        render(btn.innerText);
      });
    });

    function render(category) {
      const filtered = menus.filter((menu) => menu.cuisine === category);

      subList.innerHTML = filtered
        .map(
          (menu) =>
            `<button class="sub-item" data-id="${menu.id}">
          ${menu.name}
        </button>`,
        )
        .join("");
    }
    subList.addEventListener("click", (e) => {
      if (e.target.classList.contains("sub-item")) {
        const id = e.target.dataset.id;
        console.log("ì„ íƒëœ id:", id);

        // í•„ìš”í•˜ë©´ í•´ë‹¹ ë©”ë‰´ ì°¾ê¸°
        const selectedMenu = menus.find((menu) => menu.id == id);
        console.log(selectedMenu);
      }
    });

    subList.addEventListener("click", (e) => {
      if (e.target.classList.contains("sub-item")) {
        const id = e.target.dataset.id;

        // ğŸ”¥ í˜ì´ì§€ ì´ë™ + id ì „ë‹¬
        window.location.href = `search.html?id=${id}`;
      }
    });
  </script>
</html>
